<!--
  Generated template for the BookingPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->

<ion-header>
  <ion-navbar>
    <ion-title>
      <img button ion-button icon-only src="assets/icon/icon.png" class="app_nogal">
      <div><label>Consumos</label></div>
    </ion-title>
  </ion-navbar>
</ion-header>
<ion-content class="outer-content">
  <form (ngSubmit)="GetHistory()" #invitedForm="ngForm">
    <ion-list inset>
      <!-- <ion-item detail-push>
      <ion-label>Mes</ion-label>
      <ion-icon name="calendar" item-start></ion-icon>
      <ion-datetime displayFormat="MMMM/YYYY" (ionChange)="GetHistory()" [(ngModel)]="myDate"></ion-datetime>
    </ion-item> -->
      <ion-item>
        <ion-icon item-start name="calendar"></ion-icon>
        <ion-label>Año</ion-label>
        <ion-select name="year" [(ngModel)]="year" interface="action-sheet" (ionChange)="cleanControls(invitedForm)">
          <ion-option *ngFor="let year of lastYears">{{year}}</ion-option>
        </ion-select>

      </ion-item>
      <ion-item>
          <ion-icon item-start name="calendar"></ion-icon>
        <ion-label>Mes</ion-label>
        <ion-select name="month" [(ngModel)]="month" interface="action-sheet" (ionChange)="loadDaysMonthI()">
          <ion-option *ngFor="let month of months" [value]="month.monthValue">{{month.monthName}}</ion-option>
        </ion-select>

      </ion-item>
      <ion-item>
          <ion-icon item-start name="clock"></ion-icon>
        <ion-label>Día inicial</ion-label>
        <ion-select name="dayI" [(ngModel)]="dayI" (ionChange)="loadDaysMonthF()">
          <ion-option [value]="day" *ngFor="let day of daysInMonthI">{{day}}</ion-option>
        </ion-select>

      </ion-item>
      <ion-item>
          <ion-icon item-start name="clock"></ion-icon>
        <ion-label>Día final</ion-label>
        <ion-select name ="dayF" [(ngModel)]="dayF">
          <ion-option [value]="day" *ngFor="let day of daysInMonthF">{{day}}</ion-option>
        </ion-select>
      </ion-item>




    </ion-list>

    <div padding>
      <button type="button" ion-button full icon-end color="danger" (click)="cleanAllControls(invitedForm)">
        Limpiar
        <ion-icon name="trash"></ion-icon>
      </button>
      <button type="submit" ion-button full icon-end>
        Consultar
        <ion-icon name="eye"></ion-icon>


      </button>
    </div>
    {{year |json}}
    {{month | json}}
    {{dayI|json}}
    {{dayF|json}}
  </form>



  <ion-card *ngFor="let history of histories">
    <ion-card-header>
      <strong>Total Aprox</strong> {{total(history.lConsumos) | currency:'COP'}}
      <ion-icon item-end name="arrow-dropdown"></ion-icon>
    </ion-card-header>
    <ion-card-content *ngFor="let buy of history.lConsumos " class="animate-in-primary">
      <ion-item class="labelColorBlue">
        <ion-icon name="logo-apple" item-start></ion-icon>
        <h2>Producto</h2>
        <p>{{buy.Pro_nomb}}</p>
      </ion-item>
      <ion-item class="labelColorBlue">
        <ion-icon name="logo-usd" item-start></ion-icon>
        <h2>Valor</h2>
        <p>{{buy.Dvt_valo | currency:'COP'}}</p>
      </ion-item>
      <ion-item class="labelColorBlue">
        <ion-icon name="calendar" item-start></ion-icon>
        <h2>Fecha</h2>
        <p>{{buy.Con_fech | longDate}}</p>
      </ion-item>
    </ion-card-content>
  </ion-card>
</ion-content>