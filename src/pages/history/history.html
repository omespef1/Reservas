<!--
  Generated template for the BookingPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->

<ion-header>
  <ion-navbar>
    <ion-title>
      <img button ion-button icon-only src="assets/icon/icon.png" class="app_nogal">
      <div><label>Consumos</label></div>
    </ion-title>
  </ion-navbar>
</ion-header>
<ion-content class="outer-content">
  <form (ngSubmit)="GetHistory()" #invitedForm="ngForm">
    <ion-list inset>
      <!-- <ion-item detail-push>
      <ion-label>Mes</ion-label>
      <ion-icon name="calendar" item-start></ion-icon>
      <ion-datetime displayFormat="MMMM/YYYY" (ionChange)="GetHistory()" [(ngModel)]="myDate"></ion-datetime>
    </ion-item> -->
      <ion-item>
        <ion-icon item-start name="calendar"></ion-icon>
        <ion-label>Año</ion-label>
        <ion-select name="year" [(ngModel)]="year" interface="action-sheet" (ionChange)="GetAmbientes();loadDays()"
          required>
          <ion-option *ngFor="let year of lastYears">{{year}}</ion-option>
        </ion-select>

      </ion-item>
      <ion-item>
        <ion-icon item-start name="calendar"></ion-icon>
        <ion-label>Mes</ion-label>
        <ion-select name="month" [(ngModel)]="month" interface="action-sheet"
          (ionChange)="loadDays();GetAmbientes()">
          <ion-option *ngFor="let month of months" [value]="month.monthValue">{{month.monthName}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-icon item-start name="clock"></ion-icon>
        <ion-label>Día inicial</ion-label>
        <ion-select [disabled]="ambientesSource==undefined || ambientesSource.length==0 || month==0" name="dayI" [(ngModel)]="dayI"
          (ionChange)="loadDaysMonthF()">
          <ion-option [value]="day" *ngFor="let day of daysInMonthI">{{day}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-icon item-start name="clock"></ion-icon>
        <ion-label>Día final</ion-label>
        <ion-select [disabled]="ambientesSource==undefined || ambientesSource.length==0 || dayI==0" name="dayF" [(ngModel)]="dayF">
          <ion-option [value]="day" *ngFor="let day of daysInMonthF">{{day}}</ion-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-icon item-start name="locate"></ion-icon>
        <ion-label>Ambiente</ion-label>
        <ion-select [disabled]="ambientesSource==undefined || ambientesSource.length==0" name="ambiente"
          [(ngModel)]="ambienteS">
          <ion-option *ngFor="let ambiente of ambientesSource" [value]="ambiente.bod_cont">{{ambiente.bod_nomb}}
          </ion-option>
        </ion-select>
      </ion-item>
    </ion-list>
    <div padding>
      <button type="button" ion-button full icon-end color="danger" (click)="cleanAllControls(invitedForm)">
        Limpiar
        <ion-icon name="trash"></ion-icon>
      </button>
      <button type="submit" [disabled]="!invitedForm.form.valid" ion-button full icon-end>
        Consultar
        <ion-icon name="eye"></ion-icon>


      </button>
    </div>
   
  </form>



  <div *ngFor="let history of histories">
    <!-- <ion-card-header> -->
        <div padding>
    
      <ion-list-header color="secondary">                 
              <ion-icon item-start name="information-circle"></ion-icon>
            <ion-label>{{history.bod_nomb }}</ion-label>  
                                        
      </ion-list-header>
 
      <ion-list inset>
    <!-- </ion-card-header> -->
    <!-- <ion-card-content  class="animate-in-primary"> -->
        
        <ion-item>
            <ion-icon name="calendar" item-start></ion-icon>
            <ion-label>Fecha</ion-label>>
            <ion-note item-end>{{history.tra_fech | date:'dd/MM/yyyy'}}</ion-note>
          </ion-item>
      <ion-item>
        <ion-icon name="logo-usd" item-start></ion-icon>
        <ion-label>Propina</ion-label>
        <ion-note item-end>{{history.tra_vpro |currency:'COP'}}</ion-note>
      </ion-item>
      <ion-item>
        <ion-icon name="logo-usd" item-start></ion-icon>
        <ion-label>Total</ion-label>
      <ion-note item-end>{{history.fop_vpag | currency:'COP'}}</ion-note>
      </ion-item>    
      <ion-item>
          <ion-icon name="card" item-start></ion-icon>
          <ion-label>Forma pago</ion-label>
        <ion-note item-end>{{history.detalle[0].fop_nomb}}</ion-note>
        </ion-item>      
      <ion-item detail-push color="primary" button (click)="ShowDetail(history.detalle)">
        <ion-icon name="eye" item-start></ion-icon> Ver detalle
      </ion-item>
    </ion-list>
        </div>
    <!-- </ion-card-content> -->
  </div>
</ion-content>